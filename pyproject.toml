# SPDX-License-Identifier: Apache-2.0

[build-system]
  requires = [
    "setuptools",
    "wheel",
  ]
  build-backend = "setuptools.build_meta"

[project]
  name = "onnx-script"
  version = "0.1"
  description = "Authoring ONNX functions in Python"
  # TODO: put author/email/url/longer description into here
  # Get rid of longer description seems to require Poetry
  readme = "README.md"
  requires-python = ">=3.7"
  license = {text = 'Apache License v2.0'}
  classifiers = [
        'Development Status :: 4 - Beta',
        'Environment :: Console',
        'Intended Audience :: Developers',
        'Operating System :: MacOS :: MacOS X',
        'Operating System :: Microsoft :: Windows',
        'Programming Language :: Python',
        'Programming Language :: Python :: 3.7',
        'Programming Language :: Python :: 3.8',
        'Programming Language :: Python :: 3.9',
        'License :: OSI Approved :: Apache Software License'
  ]
  # NOTE: replace requirements.txt
  dependencies = [
    "numpy==1.21.5",
    "protobuf<4",
    "onnx",
    'importlib-metadata; python_version<"3.8"', # For py3.7 get version
  ]

  [project.optional-dependencies]
    test = [
      "flake8",
      "mypy",
      "black",
      "isort[colors]"
    ]

[tool.distutils.bdist_wheel]
  universal = true

[tool.pytest.ini_options]
  filterwarnings = [
      "ignore::UserWarning",
      "ignore::DeprecationWarning",
  ]

[tool.mypy]
  strict_optional = true
  warn_return_any = true
  warn_no_return = true
  # TODO warn_unused_ignores = true
  warn_redundant_casts = true
  warn_incomplete_stub = true
  # TODO disallow_untyped_calls = true
  check_untyped_defs = true
  disallow_any_generics = true
  no_implicit_optional = true
  # TODO disallow_incomplete_defs = true
  # TODO disallow_subclassing_any = true
  disallow_untyped_decorators = true
  warn_unused_configs = true
  show_error_codes = true
  show_column_numbers = true
  exclude = [
      "\\.git",
      "__pycache__",
  ]

  [[tool.mypy.overrides]]
    module = "tools.*"
    disallow_untyped_defs = true

  # Ignore errors in setup.py
  [[tool.mypy.overrides]]
    module = "setup"
    ignore_errors = true

[tool.black]
  target-version = ["py37", "py38", "py39", "py310"]

[tool.isort]
  profile = "black"